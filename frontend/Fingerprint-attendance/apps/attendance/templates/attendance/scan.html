<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scan Fingerprint - Attendance System</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .container {
        max-width: 500px;
        width: 100%;
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
      }

      .header h1 {
        color: #333;
        font-size: 2em;
        margin-bottom: 10px;
      }

      .header p {
        color: #666;
      }

      .scan-area {
        text-align: center;
        margin: 40px 0;
      }

      .fingerprint-icon {
        font-size: 8em;
        color: #667eea;
        margin-bottom: 20px;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      .scan-btn {
        display: inline-block;
        padding: 15px 50px;
        background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
        color: white;
        border: none;
        border-radius: 50px;
        font-size: 1.2em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .scan-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      .scan-btn:disabled {
        background: #cccccc;
        cursor: not-allowed;
      }

      .instructions {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        margin: 30px 0;
      }

      .instructions h3 {
        color: #333;
        margin-bottom: 10px;
      }

      .instructions ol {
        padding-left: 20px;
        color: #666;
      }

      .instructions li {
        margin-bottom: 10px;
      }

      .result {
        margin-top: 30px;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
      }

      .success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }

      .info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }

      .error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }

      .student-info {
        background: #e8f5e9;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
      }

      .student-info h3 {
        color: #4caf50;
        margin-bottom: 10px;
      }

      .back-btn {
        display: inline-block;
        margin-top: 20px;
        padding: 10px 30px;
        background: #667eea;
        color: white;
        text-decoration: none;
        border-radius: 50px;
      }

      .messages {
        margin-bottom: 20px;
      }

      .alert {
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 10px;
      }

      .alert-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }

      .alert-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }

      .alert-info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Messages -->
      {% if messages %}
      <div class="messages">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
      {% endif %}

      <!-- Header -->
      <div class="header">
        <h1>üëÜ Fingerprint Scan</h1>
        <p>Place your finger on the scanner to mark attendance</p>
      </div>

      <!-- Student Information (if already scanned) -->
      {% if student %}
      <div class="student-info">
        <h3>üë§ Student Detected</h3>
        <p><strong>Name:</strong> {{ student.name }}</p>
        <p><strong>Student ID:</strong> {{ student.student_id }}</p>
        {% if session %}
        <p><strong>Course:</strong> {{ session.course_name }}</p>
        {% endif %}
      </div>
      {% endif %}

      <!-- Result Display -->
      {% if success %}
      <div class="result success">
        <h2>‚úÖ Attendance Marked!</h2>
        <p>Your attendance has been successfully recorded.</p>
        <p><strong>Reference:</strong> {{ attendance_id }}</p>
        <a href="/" class="back-btn">Return to Home</a>
      </div>

      {% elif already_marked %}
      <div class="result info">
        <h2>üìù Already Marked</h2>
        <p>Your attendance for this session has already been recorded.</p>
        <a href="/" class="back-btn">Return to Home</a>
      </div>

      {% else %}
      <!-- Scan Area -->
      <div class="scan-area">
        <div class="fingerprint-icon">üëÜ</div>
        <form method="POST" id="scanForm">
          {% csrf_token %}
          <button type="submit" class="scan-btn" id="scanButton">
            Scan Fingerprint
          </button>
        </form>
      </div>

      <!-- Instructions -->
      <div class="instructions">
        <h3>üìã How to Scan:</h3>
        <ol>
          <li>Click the "Scan Fingerprint" button</li>
          <li>Place your finger firmly on the scanner</li>
          <li>Keep your finger still until scan completes</li>
          <li>Wait for confirmation message</li>
        </ol>
      </div>

      <script>
        // Simulate fingerprint scanning
        document
          .getElementById("scanForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();

            const button = document.getElementById("scanButton");
            const originalText = button.textContent;

            // Disable button and show scanning
            button.disabled = true;
            button.textContent = "Scanning... Please wait";
            button.style.background = "#FF9800";

            // Simulate scan delay (3 seconds)
            setTimeout(() => {
              // Submit form after delay
              e.target.submit();
            }, 3000);
          });
      </script>
      {% endif %}

      <!-- Footer -->
      <div
        style="
          text-align: center;
          margin-top: 30px;
          color: #666;
          font-size: 0.9em;
        "
      >
        <p>Fingerprint Attendance System v1.0</p>
        <p>Need help? Contact your instructor</p>
      </div>
    </div>
  </body>
</html>
